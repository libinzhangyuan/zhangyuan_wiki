


`mattr_accessor` 是 Rails 提供的一个用于定义**模块级别**属性的方法，类似于 `cattr_accessor` 和 `class_attribute`，但是专门用于模块（而不是类）中。它允许在模块中定义一个类级别的读写属性，通常用于模块的配置和共享数据。

### **`mattr_accessor`**

#### 功能
- 定义模块级别的属性，同时提供读写方法。
- 让模块本身拥有类似于类的类级别属性。
- 适用于模块的共享配置或常量。

#### 示例

```ruby
module ConfigModule
  mattr_accessor :setting
end

# 设置模块级别的属性
ConfigModule.setting = "模块共享值"
puts ConfigModule.setting # 输出: "模块共享值"
```

#### 特点
- **模块级别的属性**：`mattr_accessor` 主要用于模块，类似于 `cattr_accessor` 用于类。
- **共享值**：模块内的所有代码都可以访问和修改这个属性，类似于类级别的属性共享。

---

### **对比 `mattr_accessor`、`cattr_accessor` 和 `class_attribute`**
```
这三者有类似的作用，但适用的对象不同，并且它们在共享数据和继承关系方面有所不同。下面是对它们的比较：

| 特性                | `mattr_accessor`             | `cattr_accessor`           | `class_attribute`           |
|---------------------|-----------------------------|----------------------------|-----------------------------|
| **适用对象**        | 模块                        | 类                         | 类                         |
| **值的共享性**       | 模块内的共享值              | 类和实例共享值             | 子类可以独立定义自己的值     |
| **继承支持**         | 不适用于继承                | 无继承关系，但类和实例共享 | 支持继承，子类可以覆盖父类值 |
| **多线程安全**       | 共享状态可能引发问题        | 共享状态可能引发问题       | 子类和实例独立，线程安全    |
| **适用场景**         | 模块内部的共享配置或常量    | 类的全局共享配置或常量     | 继承关系中的类级别配置      |
```
---

### **总结**

- **`mattr_accessor`**：适用于模块，定义模块级别的读写属性。
- **`cattr_accessor`**：适用于类，定义类级别的共享属性，类和实例共享相同的属性值。
- **`class_attribute`**：适用于类，允许类和其子类拥有独立的类级别属性，支持继承，并且更适用于有继承关系的类。

选择使用哪个方法，取决于你的使用场景：
- **模块**：使用 `mattr_accessor`。
- **类级别共享属性**：使用 `cattr_accessor`。
- **类和子类独立属性**：使用 `class_attribute`。