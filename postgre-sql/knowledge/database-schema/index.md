[返回](/postgre-sql/knowledge/index)

# PostgreSQL 数据库(Database)与模式(Schema)对比

## 基本概念对比
```
| 对比项        | 数据库(Database)                          | 模式(Schema)                            |
|--------------|-----------------------------------------|----------------------------------------|
| **定义**      | 独立的、隔离的数据容器                     | 数据库内的命名空间(逻辑分组)               |
| **层级**      | 最顶层容器                                | 数据库内部的次级容器                      |
| **隔离性**    | 完全隔离(不同数据库无法直接互访)            | 逻辑隔离(同一数据库内可通过权限控制访问)     |
| **连接方式**  | 需要单独连接                              | 同一连接内可访问不同schema                |
```
## 功能特性对比

### 数据库(Database)
- 是PostgreSQL中的最高层次对象
- 每个数据库有独立的安全边界(需要单独连接)
- 包含自己的一组系统目录(系统表)
- 无法跨数据库直接查询(需要外部数据包装器FDW)
- 典型用例：
  - 完全隔离的应用程序
  - 多租户系统中每个租户的独立环境

### 模式(Schema)
- 是数据库内部的命名空间
- 用于逻辑组织数据库对象(表、视图、函数等)
- 共享相同的系统目录
- 可以通过search_path跨schema访问
- 典型用例：
  - 同一应用的不同模块(如hr、finance)
  - 多租户系统中同一数据库内的租户隔离
  - 版本控制(不同版本的schema)

## 实际应用场景
```
**选择数据库的场景**：
- 需要完全隔离的数据环境
- 安全要求极高，需要连接隔离
- 不同应用使用不同的身份验证
- 需要不同的数据库级配置(编码、排序规则等)

**选择模式的场景**：
- 逻辑组织大型数据库中的对象
- 实现轻量级多租户
- 管理第三方扩展(如PostGIS通常使用自己的schema)
- 同一应用的不同功能模块分组
```
## 创建示例

```sql
-- 创建数据库
CREATE DATABASE mydb WITH ENCODING='UTF8' OWNER=myuser;

-- 创建模式(在已连接的数据库中)
CREATE SCHEMA hr AUTHORIZATION hr_manager;
CREATE SCHEMA finance;
```

## 如何选择

1. **需要物理隔离** → 选择不同数据库
2. **需要逻辑组织** → 使用schema
3. **安全隔离要求高** → 优先考虑数据库
4. **资源共享需求强** → 优先考虑schema

两者也可以结合使用，例如为每个客户创建独立数据库，然后在每个数据库中使用schema组织不同业务模块。